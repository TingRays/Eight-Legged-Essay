# 单例模式

***GoF定义：保证一个类仅有一个实例，并提供一个访问它的全局访问点。***

单例即一个类是能有一个实例，并提供一个当前类的全局唯一访问入口（getInstance）。防止类被多次实例化和clone

> **php的单例,仅指进程中单例,不似java,在整个内存中单例**
> 所谓单例模式，即在应用程序中最多只有该类的一个实例存在，一旦创建，就会一直存在于内存中！

## 适用场景

单例设计模式常应用于数据库类设计，采用单例模式，只连接一次数据库，防止打开多个数据库连接。

```php

<?php
 
class Singleton
{
    private static $instance = null;
 
    // 禁止被实例化
    private function __construct()
    {
 
    }
 
    // 禁止clone
    private function __clone()
    {
 
    }
        //  实例化自己并保存到$instance中，已实例化则直接调用
    public static function getInstance(): object
    {
        if (empty(self::$instance)) {
            self::$instance = new self();
        }
        return self::$instance;
    }
 
    public function test(): string
    {
        return '这是一个单例模式';
    }
 
}
 
// 两次调用返回同一个实例
$single1 = Singleton::getInstance();
$single2 = Singleton::getInstance();
 
var_dump($single1, $single2);
echo $single1->test();
 
// new Singleton(); // Fatal error: Uncaught Error: Call to private Singleton::__construct() from invalid context
// clone $single1; // Fatal error: Uncaught Error: Call to private Singleton::__construct() from invalid context
```

